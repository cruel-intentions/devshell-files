{pkgs, config, lib, ...}: 
let 
  format = "text";
  cfg = config.files.${format};
  toFile = name: value: {
    git-add  = lib.mkIf config.files.git.auto-add true;
    on-enter = lib.mkIf config.files.on-call (lib.mkDefault false);
    source   = pkgs.writeTextFile {
      name = (builtins.baseNameOf name);
      text = value;
    };
  };
in {
  options.files.${format} = lib.mkOption {
    type = lib.types.attrsOf lib.types.lines;
    description = ''
      Create ${format} files with correponding content
    '';
    default = {};
    example."/hello.txt" =
    ''
                         (((((            *********          ****                    
                        (((((((            *********        *******                  
                        (((((((((           .*********    *********                  
                         (((((((((            *********  *********                   
                           (((((((((           *****************                     
                            (((((((((            **************                      
                 (((((((((((((((((((((((((((((((( ***********            (           
               (((((((((((((((((((((((((((((((((((( *********          (((((         
              (((((((((((((((((((((((((((((((((((((( *********        (((((((        
                           *********                   *********    /((((((((        
                          *********                     *********  (((((((((         
                        *********                         ******* ((((((((/          
                       *********                           **** (((((((((            
       ***********************.                             ,* (((((((((((((((((((((.
      ***********************                                ((((((((((((((((((((((((
       *********************.((                             (((((((((((((((((((((((( 
                 ********* ((((((                         (((((((((                  
                ********* ((((((((                       (((((((((                   
              *********    (((((((((                   (((((((((                     
             *********      (((((((((                                                
              .*****         /((((((((**************************************         
                ***           *((((((((( **********************************          
                             (((((((((((( *******************************,           
                            (((((((((((((((           ,********                      
                          ((((((((((((((((((            *********                    
                         (((((((((   (((((((((           *********                   
                       (((((((((      (((((((((            *********                 
                         ((((((         (((((((((           ******                   
    '';

  };
  config.file = lib.mapAttrs toFile cfg;
}
